{"version":3,"file":"Page-zYyg7xtI.js","sources":["../../node_modules/@mui/icons-material/esm/ArrowBackIos.js","../../node_modules/@mui/icons-material/esm/ArrowForwardIos.js","../../node_modules/@mui/icons-material/esm/Reply.js","../../src/ui/pages/document/Page.tsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z\"\n}), 'ArrowBackIos');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z\"\n}), 'ArrowForwardIos');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11\"\n}), 'Reply');","import { useEffect } from \"react\";\nimport { useEvt } from \"evt/hooks/useEvt\";\nimport { $lang } from \"ui/i18n\";\nimport { routeGroup } from \"./route\";\nimport { getCoreSync, useCoreState, getCore } from \"core\";\nimport { routes, getRoute, session } from \"ui/routes\";\nimport { assert } from \"tsafe/assert\";\nimport { withLoader } from \"ui/tools/withLoader\";\nimport { EducationalResourceHeader } from \"ui/shared/EducationalResourceHeader\";\nimport { Markdown } from \"ui/shared/Markdown\";\nimport CircularProgress from \"@mui/material/CircularProgress\";\nimport { tss } from \"ui/tss\";\nimport { useTheme as useGitlandingTheme } from \"gitlanding\";\nimport GitHubIcon from \"@mui/icons-material/GitHub\";\nimport Link from \"@mui/material/Link\";\nimport { useDomRect } from \"powerhooks/useDomRect\";\nimport { breakpointsValues } from \"ui/theme\";\nimport { Button } from \"onyxia-ui/Button\";\nimport ArrowBackIosIcon from \"@mui/icons-material/ArrowBackIos\";\nimport ArrowForwardIosIcon from \"@mui/icons-material/ArrowForwardIos\";\nimport ReplyIcon from \"@mui/icons-material/Reply\";\nimport { CoreViewText } from \"ui/shared/CoreViewText\";\nimport { declareComponentKeys, useTranslation } from \"ui/i18n\";\n\nconst Page = withLoader({\n    loader,\n    Component: Document,\n    FallbackComponent: () => null,\n});\n\nexport default Page;\n\nasync function loader() {\n    const route = getRoute();\n    assert(routeGroup.has(route));\n\n    const core = await getCore();\n\n    await core.functions.document.load({\n        routeParams: route.params,\n        language: $lang.current,\n    });\n}\n\nfunction Document() {\n    const view = useCoreState(\"document\", \"view\");\n    const {\n        functions: { document },\n        evts: { evtDocument },\n    } = getCoreSync();\n\n    useEvt(ctx => {\n        evtDocument.attach(\n            action => action.actionName === \"navigateToCatalogPage\",\n            ctx,\n            ({ routeParams }) => routes.catalog(routeParams).push(),\n        );\n    }, []);\n\n    useEffect(() => {\n        const unsubscribe_session = session.listen(route => {\n            if (routeGroup.has(route)) {\n                document.notifyRouteParamUpdated({ routeParams: route.params });\n            }\n        });\n\n        const { unsubscribe: unsubscribe_lang } = $lang.subscribe(lang =>\n            document.updateLanguage({ language: lang }),\n        );\n\n        return () => {\n            unsubscribe_session();\n            unsubscribe_lang();\n        };\n    }, []);\n\n    const { paddingRightLeft } = useGitlandingTheme();\n\n    const {\n        ref: ref_contentWrapper,\n        domRect: { right: right_contentWrapper },\n    } = useDomRect();\n\n    const { classes, theme } = useStyles({\n        paddingRightLeft,\n        isLoading: view.markdownText === undefined,\n        right_contentWrapper,\n        hasHeader: view.header !== undefined,\n    });\n\n    const { t } = useTranslation({ Document });\n\n    return (\n        <div className={classes.root}>\n            {view.header !== undefined && (\n                <EducationalResourceHeader\n                    viewHeader={view.header}\n                    onNavigateUp={document.navigateUp}\n                />\n            )}\n            <aside className={classes.aside}>\n                <div className={classes.asideInner}>\n                    <Link\n                        className={classes.editOnGitHubLink}\n                        href={view.editOnGitHubUrl}\n                        target=\"_blank\"\n                    >\n                        <GitHubIcon />\n                        {t(\"edit on github\")}\n                    </Link>\n                </div>\n            </aside>\n            <div className={classes.contentWrapper} ref={ref_contentWrapper}>\n                {view.markdownText === undefined ? (\n                    <CircularProgress />\n                ) : (\n                    <Markdown lang={view.markdownText.langAttrValue}>\n                        {view.markdownText.text}\n                    </Markdown>\n                )}\n                {view.relativeNavigation !== undefined && (\n                    <nav\n                        style={{\n                            display: \"flex\",\n                            justifyContent: \"space-between\",\n                            marginTop: theme.spacing(5),\n                        }}\n                    >\n                        {view.relativeNavigation.previous !== undefined ? (\n                            <Button\n                                startIcon={ArrowBackIosIcon}\n                                variant=\"ternary\"\n                                {...routes.document({\n                                    path: view.relativeNavigation.previous.path,\n                                }).link}\n                            >\n                                <CoreViewText\n                                    doCapitalize={true}\n                                    text={view.relativeNavigation.previous.name}\n                                />\n                            </Button>\n                        ) : (\n                            <div />\n                        )}\n                        {view.relativeNavigation.next !== undefined && (\n                            <Button\n                                endIcon={ArrowForwardIosIcon}\n                                variant=\"ternary\"\n                                {...routes.document({\n                                    path: view.relativeNavigation.next.path,\n                                }).link}\n                            >\n                                <CoreViewText\n                                    doCapitalize={true}\n                                    text={view.relativeNavigation.next.name}\n                                />\n                            </Button>\n                        )}\n                        {view.relativeNavigation.back !== undefined && (\n                            <Button\n                                startIcon={ReplyIcon}\n                                variant=\"ternary\"\n                                {...routes.catalog({\n                                    path: view.relativeNavigation.back.path,\n                                }).link}\n                            >\n                                <CoreViewText\n                                    doCapitalize={true}\n                                    text={view.relativeNavigation.back.name}\n                                />\n                            </Button>\n                        )}\n                    </nav>\n                )}\n            </div>\n        </div>\n    );\n}\n\nconst useStyles = tss\n    .withName({ Document })\n    .withParams<{\n        paddingRightLeft: number;\n        isLoading: boolean;\n        right_contentWrapper: number;\n        hasHeader: boolean;\n    }>()\n    .create(\n        ({ theme, paddingRightLeft, isLoading, right_contentWrapper, hasHeader }) => ({\n            root: {\n                ...theme.spacing.rightLeft(\"padding\", `${paddingRightLeft}px`),\n                paddingTop: hasHeader ? undefined : theme.spacing(5),\n            },\n            contentWrapper: {\n                textAlign: isLoading ? \"center\" : undefined,\n                maxWidth: \"82ch\",\n                ...theme.spacing.rightLeft(\n                    \"padding\",\n                    `${theme.typography.rootFontSizePx}px`,\n                ),\n                ...theme.spacing.topBottom(\"padding\", 5),\n                ...theme.spacing.rightLeft(\"margin\", \"auto\"),\n            },\n            editOnGitHubLink: {\n                display: \"inline-flex\",\n                alignItems: \"center\",\n                gap: theme.spacing(2),\n                position: \"sticky\",\n                top: theme.spacing(6),\n            },\n            aside: {\n                display:\n                    theme.windowInnerWidth < breakpointsValues.md ? \"none\" : undefined,\n                position: \"sticky\",\n                top: theme.spacing(6),\n                textWrap: \"nowrap\",\n                height: 0,\n                width: 0,\n                overflow: \"visible\",\n                marginLeft: right_contentWrapper - paddingRightLeft + theme.spacing(5),\n            },\n            asideInner: {\n                overflow: \"visible\",\n                display: \"inline-flex\",\n            },\n        }),\n    );\n\nconst { i18n } = declareComponentKeys<\"edit on github\">()({ Document });\n\nexport type I18n = typeof i18n;\n"],"names":["ArrowBackIosIcon","createSvgIcon","_jsx","ArrowForwardIosIcon","ReplyIcon","Page","withLoader","loader","Document","route","getRoute","assert","routeGroup","getCore","$lang","view","useCoreState","document","evtDocument","getCoreSync","useEvt","ctx","action","routeParams","routes","useEffect","unsubscribe_session","session","unsubscribe_lang","lang","paddingRightLeft","useGitlandingTheme","ref_contentWrapper","right_contentWrapper","useDomRect","classes","theme","useStyles","t","useTranslation","jsxs","jsx","EducationalResourceHeader","Link","GitHubIcon","CircularProgress","Markdown","Button","CoreViewText","tss","isLoading","hasHeader","breakpointsValues","i18n","declareComponentKeys"],"mappings":"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","x_google_ignoreList":[0,1,2]}